# ==========================================
# 🖼️ TC-GO 图床系统环境变量配置
# ==========================================
# 📝 使用说明:
#   1. 复制此文件为 .env
#   2. 根据实际情况修改配置项
#   3. 生产环境务必修改所有密钥和密码
#   4. 重启服务生效
#
# 💡 快速开始:
#   开发环境: 使用 SQLite + 本地存储，无需额外配置
#   生产环境: 建议使用 PostgreSQL/MySQL + 对象存储 + Redis缓存
#
# 📖 详细文档:
#   存储配置: STORAGE_GUIDE.md
#   快速开始: QUICK_START.md
# ==========================================

# ==================== 数据库配置 ====================
# 数据库类型: sqlite, postgres, mysql
# 说明:
#   - sqlite: 适合开发和小规模部署，无需额外安装数据库
#   - postgres: 推荐用于生产环境，性能强劲，支持高并发
#   - mysql: 兼容性好，适合中大规模部署
DB_TYPE=sqlite

# SQLite 数据库路径（DB_TYPE=sqlite 时使用）
DB_DSN=./data/imagebed.db

# PostgreSQL 数据库连接（DB_TYPE=postgres 时使用）
# 取消注释并修改下面两行
# DB_TYPE=postgres
# DB_DSN=host=localhost port=5432 user=postgres password=your_strong_password dbname=imagebed sslmode=disable

# MySQL 数据库连接（DB_TYPE=mysql 时使用）
# 取消注释并修改下面两行
# DB_TYPE=mysql
# DB_DSN=root:your_strong_password@tcp(localhost:3306)/imagebed?charset=utf8mb4&parseTime=True&loc=Local

# ==================== Redis 缓存配置 ====================
# 是否启用Redis缓存（true/false）
# 说明:
#   - 启用后可显著提升性能，减少数据库压力
#   - SQLite建议启用，PostgreSQL/MySQL可选
#   - 开发环境可不启用，生产环境强烈建议启用
REDIS_ENABLED=false

# Redis 服务器地址
REDIS_ADDR=localhost:6379

# Redis 密码（如果没有密码则留空）
REDIS_PASSWORD=

# Redis 数据库编号（0-15）
# 建议不同服务使用不同的DB编号避免冲突
REDIS_DB=0

# 缓存过期时间（支持: 10s, 5m, 1h, 24h 等）
# 示例:
#   - 10s: 10秒
#   - 5m: 5分钟
#   - 1h: 1小时
#   - 24h: 24小时
CACHE_TTL=10m

# ==================== 服务器配置 ====================
# 服务器监听端口
SERVER_PORT=8080

# 运行模式: debug, release
# 说明:
#   - debug: 开发模式，详细日志输出
#   - release: 生产模式，性能优化
SERVER_MODE=debug

# ==================== JWT 认证配置 ====================
# JWT 密钥（用于生成和验证用户Token）
# ⚠️ 生产环境请务必修改为强随机字符串！
# 生成建议: openssl rand -hex 32
JWT_SECRET=your-secret-key-change-this-in-production-f8a3d9c2e1b7

# JWT 过期时间（支持: 1h, 24h, 168h 等）
# 示例:
#   - 1h: 1小时
#   - 24h: 24小时（推荐）
#   - 168h: 7天
JWT_EXPIRATION=24h

# ==================== 用户管理配置 ====================
# 是否允许新用户注册（true/false）
# 说明:
#   - true: 开放注册，任何人都可以创建账号
#   - false: 关闭注册，只有管理员可以创建用户
#   - 生产环境建议关闭，通过管理后台添加用户
ALLOW_REGISTRATION=true

# ==================== 文件上传配置 ====================
# 文件上传临时存储路径（用于本地存储模式）
UPLOAD_PATH=./uploads

# 单文件最大上传大小（单位: MB）
# 说明:
#   - 需要同时修改 Nginx 的 client_max_body_size 配置
#   - 建议范围: 10-200MB
MAX_FILE_SIZE=100

# ==================== 日志配置 ====================
# 日志文件路径
LOG_PATH=./logs/app.log

# 单个日志文件最大大小（单位: MB）
LOG_MAX_SIZE=100

# 日志文件保留天数
LOG_MAX_AGE=30

# 日志文件最大备份数
LOG_MAX_BACKUPS=10

# ==================== 存储配置 ====================
# 存储类型: local, oss, cos, qiniu, s3, webdav, sftp
# 说明:
#   - local: 本地存储（开发环境推荐）
#   - oss: 阿里云OSS（国内推荐）
#   - cos: 腾讯云COS（国内推荐）
#   - qiniu: 七牛云（国内推荐）
#   - s3: AWS S3 或兼容S3的存储（如MinIO）
#   - webdav: WebDAV协议存储（坚果云、NextCloud等）
#   - sftp: SFTP服务器存储
STORAGE_TYPE=local

# -------------------- 本地存储配置 --------------------
# 本地存储路径（相对路径或绝对路径）
STORAGE_LOCAL_PATH=./uploads

# 访问基础URL（用于生成访问链接）
# 示例:
#   - 开发环境: /api/files
#   - 生产环境: https://cdn.yourdomain.com/files
STORAGE_BASE_URL=/api/files

# -------------------- 阿里云OSS配置 --------------------
# OSS Endpoint（访问域名）
# 格式: oss-{区域}.aliyuncs.com
# 示例: oss-cn-hangzhou.aliyuncs.com, oss-cn-beijing.aliyuncs.com
# 区域列表: https://help.aliyun.com/document_detail/31837.html
OSS_ENDPOINT=

# OSS Access Key ID（访问密钥ID）
OSS_ACCESS_KEY_ID=

# OSS Access Key Secret（访问密钥）
OSS_ACCESS_KEY_SECRET=

# OSS Bucket名称
OSS_BUCKET=

# OSS 内的基础路径（可选，以/结尾）
# 示例: imagebed/, images/2024/
OSS_BASE_PATH=

# -------------------- 腾讯云COS配置 --------------------
# COS 区域（Region）
# 示例: ap-guangzhou, ap-shanghai, ap-beijing
# 区域列表: https://cloud.tencent.com/document/product/436/6224
COS_REGION=

# COS Secret ID（密钥ID）
COS_SECRET_ID=

# COS Secret Key（密钥）
COS_SECRET_KEY=

# COS Bucket名称（格式: bucket-appid）
# 示例: mybucket-1250000000
COS_BUCKET=

# COS 内的基础路径（可选，以/结尾）
# 示例: imagebed/, images/2024/
COS_BASE_PATH=

# -------------------- 七牛云配置 --------------------
# 七牛云 Access Key（访问密钥）
QINIU_ACCESS_KEY=

# 七牛云 Secret Key（密钥）
QINIU_SECRET_KEY=

# 七牛云 Bucket名称
QINIU_BUCKET=

# 七牛云绑定的CDN加速域名（用于访问文件）
# 示例: https://cdn.example.com 或 http://abc123.clouddn.com
QINIU_DOMAIN=

# 七牛云存储区域
# 选项:
#   - z0: 华东-浙江
#   - z1: 华北-河北
#   - z2: 华南-广东
#   - na0: 北美-洛杉矶
#   - as0: 亚太-新加坡
QINIU_REGION=z0

# 七牛云内的基础路径（可选，以/结尾）
# 示例: imagebed/, images/2024/
QINIU_BASE_PATH=

# -------------------- S3/MinIO配置 --------------------
# S3 Endpoint（访问端点）
# 示例:
#   - AWS S3: s3.amazonaws.com
#   - MinIO: minio.example.com:9000
#   - 其他S3兼容存储的访问地址
S3_ENDPOINT=

# S3 Access Key ID（访问密钥ID）
S3_ACCESS_KEY_ID=

# S3 Secret Access Key（访问密钥）
S3_SECRET_ACCESS_KEY=

# S3 Bucket名称
S3_BUCKET=

# S3 Region（区域）
# 示例: us-east-1, ap-northeast-1
# MinIO可以填写任意值，如: us-east-1
S3_REGION=

# S3 内的基础路径（可选，以/结尾）
# 示例: imagebed/, images/2024/
S3_BASE_PATH=

# S3 是否使用SSL（true/false）
# 说明:
#   - true: 使用 HTTPS 协议（推荐）
#   - false: 使用 HTTP 协议（本地MinIO开发环境可用）
S3_USE_SSL=true

# -------------------- WebDAV配置 --------------------
# 适用于: 坚果云、NextCloud、ownCloud 等支持WebDAV的服务
#
# WebDAV 服务器地址
# 示例:
#   - 坚果云: https://dav.jianguoyun.com/dav/
#   - NextCloud: https://cloud.example.com/remote.php/dav/files/username/
WEBDAV_URL=

# WebDAV 用户名
# 坚果云使用邮箱作为用户名
WEBDAV_USERNAME=

# WebDAV 密码
# 坚果云需要使用应用密码，不是登录密码
WEBDAV_PASSWORD=

# WebDAV 内的基础路径（以/开头和结尾）
# 示例: /imagebed/, /photos/2024/
WEBDAV_BASE_PATH=/

# WebDAV 公网访问URL前缀（用于生成访问链接）
# 如果WebDAV服务支持直接访问，填写对应的URL
# 示例: https://your-domain.com/files
WEBDAV_BASE_URL=

# -------------------- SFTP配置 --------------------
# SFTP 服务器地址
SFTP_HOST=

# SFTP 端口（默认22）
SFTP_PORT=22

# SFTP 用户名
SFTP_USERNAME=

# SFTP 密码认证（二选一）
SFTP_PASSWORD=

# SFTP 私钥认证（二选一，与密码认证二选一）
# 填写私钥文件的绝对路径
# 示例: /home/user/.ssh/id_rsa
SFTP_PRIVATE_KEY=

# SFTP 服务器上的基础路径（以/结尾）
# 示例: /var/www/imagebed/, /home/user/files/
SFTP_BASE_PATH=/

# SFTP 公网访问URL前缀（用于生成访问链接）
# 示例: https://your-domain.com/files
SFTP_BASE_URL=

# ==================== 日志配置 ====================
# 日志文件路径
LOG_PATH=./logs/app.log

# 单个日志文件最大大小 (单位: MB)
LOG_MAX_SIZE=100

# 日志文件保留天数
LOG_MAX_AGE=30

# 日志文件最大备份数
LOG_MAX_BACKUPS=10

# ==================== 短链服务配置 ====================
# 是否启用短链功能（true/false）
# 说明:
#   - true: 启用短链功能，图片上传后自动生成短链
#   - false: 禁用短链功能
SHORT_LINK_ENABLED=false

# 短链服务基础URL（短链重定向服务的访问地址）
# 示例:
#   - 开发环境: http://localhost:8081
#   - 生产环境: https://short.yourdomain.com
# 注意: 不要以 / 结尾
SHORT_LINK_BASE_URL=http://localhost

# 短链默认过期时间（秒），0表示永不过期
# 示例:
#   - 0: 永不过期（推荐）
#   - 604800: 7天
#   - 2592000: 30天
#   - 31536000: 365天
SHORT_LINK_EXPIRE=0

# 短链服务API密钥（用于调用短链服务API）
# 说明:
#   - 如果短链服务启用了API KEY验证，需要填写对应的KEY
#   - 留空则不进行API KEY验证
#   - 需要与短链服务的 API_KEY 配置一致
SHORT_LINK_API_KEY=

# ==================== CORS 跨域配置 ====================
# 是否启用CORS（true/false）
# 说明:
#   - 前后端分离部署时必须启用
#   - 同域部署可以不启用
CORS_ENABLED=true

# 允许的源（逗号分隔，不要有空格）
# 开发环境示例（支持本地开发的常用端口）:
CORS_ALLOW_ORIGINS=http://localhost:5173,http://localhost:5174,http://localhost:3000,http://127.0.0.1:5173,http://127.0.0.1:5174,http://127.0.0.1:3000
# 生产环境示例:
# CORS_ALLOW_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# 允许的HTTP方法（逗号分隔）
CORS_ALLOW_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS

# 允许的请求头（逗号分隔）
CORS_ALLOW_HEADERS=Origin,Content-Type,Accept,Authorization

# 预检请求缓存时间（小时）
# 说明: 浏览器会缓存预检请求结果，减少OPTIONS请求次数
CORS_MAX_AGE=12

# ==========================================
# 📝 兼容旧配置（不推荐使用）
# ==========================================
# 以下配置项为旧版本兼容，建议使用上面的新配置
DATABASE_PATH=./data/imagebed.db
SECRET_KEY=your-secret-key-change-this-in-production

# ==========================================
# 💡 配置示例和常见场景
# ==========================================
#
# 🏠 场景1: 本地开发环境（最简单）
# -----------------------------------
# DB_TYPE=sqlite
# DB_DSN=./data/imagebed.db
# REDIS_ENABLED=false
# STORAGE_TYPE=local
# STORAGE_LOCAL_PATH=./uploads
# SHORT_LINK_ENABLED=false
# SERVER_MODE=debug
#
# 🌐 场景2: 生产环境 - 阿里云OSS
# -----------------------------------
# DB_TYPE=postgres
# DB_DSN=host=localhost port=5432 user=imagebed password=xxx dbname=imagebed sslmode=disable
# REDIS_ENABLED=true
# REDIS_ADDR=localhost:6379
# STORAGE_TYPE=oss
# OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com
# OSS_ACCESS_KEY_ID=your_key_id
# OSS_ACCESS_KEY_SECRET=your_key_secret
# OSS_BUCKET=your_bucket
# SHORT_LINK_ENABLED=true
# SHORT_LINK_BASE_URL=https://s.yourdomain.com
# SERVER_MODE=release
# JWT_SECRET=<使用 openssl rand -hex 32 生成>
#
# 🚀 场景3: 生产环境 - 七牛云存储
# -----------------------------------
# DB_TYPE=mysql
# DB_DSN=root:password@tcp(localhost:3306)/imagebed?charset=utf8mb4&parseTime=True&loc=Local
# REDIS_ENABLED=true
# STORAGE_TYPE=qiniu
# QINIU_ACCESS_KEY=your_access_key
# QINIU_SECRET_KEY=your_secret_key
# QINIU_BUCKET=your_bucket
# QINIU_DOMAIN=https://cdn.yourdomain.com
# QINIU_REGION=z0
# SHORT_LINK_ENABLED=true
# SHORT_LINK_BASE_URL=https://s.yourdomain.com
# SHORT_LINK_API_KEY=your-api-key-here
# SERVER_MODE=release
#
# 💾 场景4: 自建存储 - MinIO
# -----------------------------------
# STORAGE_TYPE=s3
# S3_ENDPOINT=minio.yourdomain.com:9000
# S3_ACCESS_KEY_ID=minioadmin
# S3_SECRET_ACCESS_KEY=minioadmin
# S3_BUCKET=imagebed
# S3_REGION=us-east-1
# S3_USE_SSL=false
#
# ☁️ 场景5: WebDAV存储 - 坚果云
# -----------------------------------
# STORAGE_TYPE=webdav
# WEBDAV_URL=https://dav.jianguoyun.com/dav/
# WEBDAV_USERNAME=your_email@example.com
# WEBDAV_PASSWORD=your_app_password
# WEBDAV_BASE_PATH=/imagebed/
# WEBDAV_BASE_URL=https://your-domain.com/files
#
# ==========================================
# ⚠️ 注意事项
# ==========================================
# 1. 生产环境务必修改以下配置:
#    - JWT_SECRET: 使用强随机字符串
#    - 数据库密码: 使用强密码
#    - ALLOW_REGISTRATION: 建议设为 false
#
# 2. 数据库说明:
#    - SQLite: 适合个人使用和小规模部署
#    - PostgreSQL/MySQL: 生产环境推荐，需要先创建数据库
#
# 3. Redis缓存:
#    - 可选但强烈推荐，能显著提升性能
#    - 特别是使用 PostgreSQL/MySQL 时
#
# 4. 对象存储:
#    - 生产环境推荐使用对象存储（OSS/COS/七牛云/S3）
#    - 本地存储需要考虑备份和容量问题
#
# 5. 短链服务:
#    - 需要单独部署短链重定向服务
#    - 配置 SHORT_LINK_BASE_URL 为短链服务地址
#    - 详见: redirect-service 目录
#
# 6. CORS配置:
#    - 前后端分离部署时必须配置
#    - 生产环境配置实际域名，不要使用通配符 *
#
# 7. 文件上传大小:
#    - 修改 MAX_FILE_SIZE 后还需要调整 Nginx 配置
#    - Nginx: client_max_body_size
#
# ==========================================
# 📚 相关文档
# ==========================================
# - 存储配置指南: STORAGE_GUIDE.md
# - 快速开始: QUICK_START.md
# - WebDAV/SFTP配置: WEBDAV_SFTP_QUICK_START.md
# - 短链服务: redirect-service/ROUTING_README.md
# ==========================================

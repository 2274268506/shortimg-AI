# 系统设置功能说明

## 📋 新增设置模块

### 1. 🎨 显示设置

#### 主题模式
- **浅色**：传统白色背景主题
- **深色**：暗色护眼主题
- **跟随系统**：自动切换（根据操作系统设置）

#### 默认视图
- **网格视图**：图片以卡片形式展示，适合浏览
- **列表视图**：详细信息列表，适合管理

#### 每页显示数量
- 可选：12、24、48、96 张图片
- 影响图片列表和相册的分页大小

#### 图片缩略图质量
- 范围：50% - 100%
- 较低质量提升加载速度
- 较高质量显示更清晰

#### 图片懒加载
- 启用后只加载可见区域的图片
- 显著提升大量图片时的加载性能

#### 显示选项
- **显示文件大小**：在图片卡片上显示文件大小
- **显示上传日期**：显示图片上传时间

---

### 2. 📤 上传设置

#### 默认图片格式
- **保持原格式**：不转换
- **JPEG**：适合照片，文件小
- **PNG**：适合截图，支持透明
- **WebP**：现代格式，体积更小

#### 默认压缩质量
- 范围：60% - 100%
- 影响 JPEG 和 WebP 格式
- 建议值：85%（平衡质量和大小）

#### 最大文件大小
- 范围：1MB - 100MB
- 超过此大小的文件将被拒绝
- 防止上传过大文件

#### 允许的格式
可选择允许上传的图片格式：
- JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)
- WebP (.webp)
- BMP (.bmp)
- TIFF (.tiff, .tif)

#### 自动生成缩略图
- 启用后上传时自动生成缩略图
- 提升图片列表加载速度

#### 保留 EXIF 信息
- **保留**：保持拍摄时间、GPS、相机信息等
- **移除**：清除所有元数据，保护隐私

---

### 3. ⚡ 性能设置

#### 启用请求缓存
- 缓存 API 响应数据
- 减少网络请求，提升响应速度

#### 缓存有效期
- 范围：60 秒 - 1 小时
- 缓存过期后重新请求

#### 预加载下一页
- 提前加载下一页数据
- 无缝翻页体验

#### 并发上传数
- 范围：1 - 10 个文件
- 批量上传时同时处理的文件数
- 建议值：3-5（平衡速度和稳定性）

#### 请求超时时间
- 范围：5000ms - 60000ms
- API 请求的最大等待时间

#### 清除缓存
- 一键清除所有本地缓存数据
- 保留用户设置和登录状态

---

### 4. 🔔 通知设置

#### 上传完成通知
- 文件上传完成时显示提示

#### 操作成功提示
- 删除、移动、转换等操作成功时提示

#### 错误提示
- 操作失败时显示错误信息

#### 通知停留时间
- 范围：1000ms - 10000ms
- 消息自动关闭的时间

#### 通知位置
- 右上角（默认）
- 右下角
- 左上角
- 左下角

---

### 5. 🔒 防盗链设置

#### 防盗链保护
- 通过 HTTP Referer 头限制访问来源
- 只有白名单域名可以引用图片

#### Token 验证
- 为图片 URL 添加签名 token
- Token 包含过期时间
- 适合生成临时分享链接

#### 允许的域名
- 添加允许访问图片的域名
- 默认：localhost、127.0.0.1

#### Token 有效期
- 范围：60 秒 - 24 小时
- 签名 URL 的有效时间

#### 测试签名 URL
- 输入图片 ID 生成测试链接
- 验证防盗链功能是否正常

---

### 6. 🔧 全局操作

#### 保存所有设置
- 一键保存所有配置项
- 自动写入 localStorage

#### 重置所有设置
- 恢复为默认配置
- 需要二次确认

#### 导出配置
- 导出为 JSON 文件
- 文件名：`tc-go-settings-{timestamp}.json`
- 包含所有设置项

#### 导入配置
- 从 JSON 文件导入设置
- 自动验证文件格式
- 支持部分导入（合并现有设置）

---

## 💾 数据存储

所有设置保存在浏览器 localStorage 中：

```
localStorage:
├── display-settings       # 显示设置
├── upload-settings        # 上传设置
├── performance-settings   # 性能设置
├── notification-settings  # 通知设置
├── hotlink-settings       # 防盗链设置
└── config                 # 系统配置（后端地址等）
```

---

## 🚀 使用示例

### 导出配置文件格式

```json
{
  "version": "1.0",
  "exportTime": "2025-12-04T10:30:00.000Z",
  "settings": {
    "display": {
      "theme": "light",
      "defaultView": "grid",
      "pageSize": 24,
      "thumbnailQuality": 80,
      "lazyLoad": true,
      "showFileSize": true,
      "showUploadDate": true
    },
    "upload": {
      "defaultFormat": "original",
      "quality": 85,
      "maxFileSize": 10,
      "allowedFormats": ["jpg", "png", "gif", "webp"],
      "autoThumbnail": true,
      "keepExif": false
    },
    "performance": {
      "enableCache": true,
      "cacheDuration": 300,
      "preloadNextPage": true,
      "concurrentUploads": 3,
      "requestTimeout": 30000
    },
    "notification": {
      "uploadComplete": true,
      "successNotify": true,
      "errorNotify": true,
      "duration": 3000,
      "position": "top-right"
    },
    "hotlink": {
      "hotlinkProtection": false,
      "tokenProtection": false,
      "allowedDomains": ["localhost", "127.0.0.1"],
      "tokenTTL": 3600
    }
  }
}
```

---

## 🎯 最佳实践建议

### 性能优化配置
```
✅ 启用请求缓存：是
✅ 缓存有效期：300 秒
✅ 预加载下一页：是
✅ 图片懒加载：是
✅ 缩略图质量：70-80%
```

### 上传优化配置
```
✅ 默认格式：WebP（文件更小）
✅ 压缩质量：85%
✅ 自动生成缩略图：是
✅ 移除 EXIF：是（保护隐私）
✅ 并发上传数：3
```

### 用户体验配置
```
✅ 主题模式：跟随系统
✅ 每页显示：24 张
✅ 上传完成通知：是
✅ 通知停留时间：3000ms
```

---

## 📊 设置影响范围

| 设置项 | 影响组件 | 立即生效 |
|--------|---------|---------|
| 主题模式 | 全局 | ❌ (需刷新) |
| 默认视图 | ImageManager | ✅ |
| 每页显示 | ImageGrid, ImageList | ✅ |
| 缩略图质量 | ImageCard | ❌ (新加载生效) |
| 懒加载 | ImageCard | ✅ |
| 默认格式 | UploadDialog | ✅ |
| 压缩质量 | UploadDialog | ✅ |
| 并发上传 | BatchUpload | ✅ |
| 通知设置 | 全局 Message | ✅ |

---

## 🔍 常见问题

### Q: 设置保存在哪里？
A: 保存在浏览器的 localStorage 中，清除浏览器数据会丢失设置。

### Q: 导出的配置可以在不同浏览器间共享吗？
A: 可以！导出配置文件后，在任意浏览器导入即可。

### Q: 修改设置后需要刷新页面吗？
A: 大部分设置立即生效，主题模式等少数设置需要刷新。

### Q: 清除缓存会清除我的设置吗？
A: 不会。清除缓存功能会保留所有设置项。

### Q: 防盗链设置需要后端支持吗？
A: 是的，需要在后端启用相应的中间件才能生效。

---

## 🎨 界面预览

系统设置页面包含以下卡片：

1. **系统配置** - 后端服务地址、连接测试
2. **显示设置** - 主题、视图、分页等
3. **上传设置** - 格式、质量、大小限制等
4. **性能设置** - 缓存、并发、超时等
5. **通知设置** - 提示类型、位置、时长等
6. **防盗链设置** - 域名白名单、Token 验证
7. **使用说明** - 功能说明文档
8. **全局操作** - 保存、重置、导出、导入

所有设置采用响应式布局，支持移动端访问！

---

## 🚀 下一步优化建议

1. **主题切换功能**
   - 实现深色/浅色主题切换
   - CSS 变量支持
   - 平滑过渡动画

2. **设置同步**
   - 将设置保存到后端
   - 多设备间同步配置
   - 账号绑定设置

3. **高级配置**
   - 快捷键自定义
   - 自定义 CSS 样式
   - 插件系统

4. **设置搜索**
   - 快速查找设置项
   - 智能推荐

5. **配置预设**
   - 性能优先模式
   - 质量优先模式
   - 平衡模式

---

完成！系统设置页面现已包含 **6 大设置模块**，**40+ 配置项**，提供完整的自定义体验！🎉

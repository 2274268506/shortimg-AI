# 🔧 前端后端地址配置功能

## ✅ 已添加功能

### 登录页面新增后端设置按钮

**位置：** 登录页面右上角

**功能：**
1. ✅ 显示当前后端地址
2. ✅ 配置后端服务器地址
3. ✅ 预设常用地址选择
4. ✅ 保存并测试连接
5. ✅ 实时连接状态反馈

## 📱 使用方法

### 步骤 1：打开登录页面
访问前端应用的登录页面

### 步骤 2：点击"后端设置"按钮
在登录表单右上角找到"后端设置"按钮并点击

### 步骤 3：配置后端地址

**方法 A：手动输入**
```
输入框中填入完整的后端地址，例如：
• https://img.oxvxo.link
• http://localhost:8080
• http://192.168.1.100:8080
```

**方法 B：选择预设地址**
从下拉菜单选择：
- 本地开发 (localhost:8080)
- 本地开发 (127.0.0.1:8080)
- 生产环境 (img.oxvxo.link)

### 步骤 4：保存并测试
点击"保存并测试连接"按钮，系统会：
1. 测试连接到后端服务器
2. 验证健康检查接口
3. 保存配置到浏览器本地存储
4. 显示连接状态

### 步骤 5：登录
配置成功后即可正常登录

## 🎯 界面说明

### 登录页面显示
```
┌─────────────────────────────┐
│  登录/注册    [后端设置]     │
├─────────────────────────────┤
│  用户名: [_______________]  │
│  密码:   [_______________]  │
│                             │
│  ℹ️ 当前后端地址:            │
│     https://img.oxvxo.link  │
│                             │
│     [登录]                  │
└─────────────────────────────┘
```

### 后端设置对话框
```
┌─────────────────────────────┐
│  后端服务器设置              │
├─────────────────────────────┤
│  后端地址:                   │
│  🔗 [https://img.oxvxo.link]│
│                             │
│  💡 请输入完整的后端地址     │
│     • https://img.oxvxo.link│
│     • http://localhost:8080 │
│                             │
│  预设地址:                   │
│  [▼ 选择预设地址]           │
│                             │
│  [保存并测试连接] [取消]    │
│                             │
│  ✅ 连接成功！               │
│     后端服务正常运行。       │
└─────────────────────────────┘
```

## 🔍 连接状态说明

### ✅ 成功
```
✅ 连接成功！后端服务正常运行。
```
- 配置已保存
- 后端服务可用
- 可以正常登录

### ⚠️ 警告
```
⚠️ 服务器响应异常，但地址已保存。
```
- 配置已保存
- 但后端可能有问题
- 建议检查后端服务

### ❌ 错误
```
❌ 连接失败: 无法连接到后端服务器
```
- 无法连接到指定地址
- 请检查：
  - 地址是否正确
  - 后端服务是否启动
  - 网络是否正常
  - CORS 是否配置

## 💾 配置存储

配置保存在浏览器本地存储中：
- **存储位置：** `localStorage`
- **键名：** `imagebed_config`
- **数据格式：** JSON

### 查看当前配置
在浏览器控制台执行：
```javascript
console.log(localStorage.getItem('imagebed_config'))
```

### 手动设置（高级）
```javascript
localStorage.setItem('imagebed_config', JSON.stringify({
  backendUrl: 'https://img.oxvxo.link'
}))
```

## 🚀 部署建议

### 开发环境
```
后端地址: http://localhost:8080
```

### 生产环境

#### 同域名部署
如果前后端在同一个域名下：
```
前端: https://img.oxvxo.link
后端: https://img.oxvxo.link/api
配置: https://img.oxvxo.link
```

#### 不同域名部署
如果前后端分离部署：
```
前端: https://www.example.com
后端: https://api.example.com
配置: https://api.example.com
```

⚠️ **注意：** 跨域部署需要确保后端 CORS 配置正确！

## 🔒 CORS 配置

### 后端 `.env` 配置示例

```env
# 允许的前端域名（逗号分隔）
CORS_ALLOW_ORIGINS=https://img.oxvxo.link,https://www.img.oxvxo.link,http://localhost:5173
```

### 常见 CORS 问题

#### 问题 1：跨域请求被阻止
```
Access to XMLHttpRequest has been blocked by CORS policy
```

**解决：** 在后端 `.env` 中添加前端域名到 `CORS_ALLOW_ORIGINS`

#### 问题 2：HTTPS 访问 HTTP
```
Permission was denied for this request to access the `unknown` address space
```

**解决：**
- 方案 A：前端和后端都使用 HTTPS
- 方案 B：前端和后端都使用 HTTP（仅开发环境）

## 📝 修改记录

### 修改的文件
- `frontend/src/views/Login.vue`

### 新增功能
1. ✅ 后端设置按钮
2. ✅ 后端设置对话框
3. ✅ 地址输入和验证
4. ✅ 预设地址选择
5. ✅ 连接测试功能
6. ✅ 状态实时反馈
7. ✅ 当前地址显示

### 新增依赖
- `axios` - 用于测试连接（已有依赖）
- `Element Plus` 图标：
  - `Setting` - 设置图标
  - `Link` - 链接图标

## 🎉 完成！

现在用户可以在登录页面轻松配置后端地址，无需修改代码或配置文件！

### 使用流程
```
1. 打开登录页面
2. 点击"后端设置"
3. 输入或选择后端地址
4. 点击"保存并测试连接"
5. 等待连接成功
6. 开始登录使用
```

简单快捷！🚀

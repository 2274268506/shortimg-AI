# ==========================================
# 短链服务 - 生产环境配置模板
# ==========================================
# 部署前请复制此文件为 .env 并修改相关配置
# ==========================================

# ==================== MySQL 数据库配置 ====================
# MySQL root 密码
MYSQL_ROOT_PASSWORD=your_secure_root_password_here
# 数据库名称
MYSQL_DATABASE=short_links
# 数据库用户名
MYSQL_USER=short_link
# 数据库用户密码
MYSQL_PASSWORD=your_secure_password_here
# MySQL 外部端口（宿主机映射端口）
MYSQL_EXTERNAL_PORT=3307

# ==================== Redis 配置 ====================
# Redis 主机（Docker 容器名或IP）
REDIS_HOST=shortlink-redis-prod
# Redis 端口
REDIS_PORT=6379
# Redis 密码（建议设置强密码）
REDIS_PASSWORD=your_redis_password_here
# Redis 数据库编号（重要：必须与图床服务API Key存储的数据库一致）
REDIS_DB=1
# Redis 外部端口（宿主机映射端口）
REDIS_EXTERNAL_PORT=6380

# ==================== 短链服务配置 ====================
# 短链服务HTTP端口（内部使用，通过Nginx反向代理）
REDIRECT_PORT=8081
# 短链服务HTTPS端口（可选）
REDIRECT_SSL_PORT=8444

# 短链服务域名（用于生成短链接）
REDIRECT_DOMAIN=short.yourdomain.com
# 短链服务协议
REDIRECT_PROTOCOL=https

# ==================== 图床服务配置 ====================
# 主图床服务器域名
TC_GO_PRIMARY_DOMAIN=img.yourdomain.com
TC_GO_PRIMARY_PROTOCOL=https

# 备用图床服务器（可选，留空表示不使用）
TC_GO_BACKUP_DOMAIN=
TC_GO_BACKUP_PROTOCOL=https

# ==================== CDN 分流配置 ====================

# ==== 图床服务器CDN配置 ====
# 联通用户CDN
CDN_IMAGEBED_UNICOM_DOMAIN=img.yourdomain.com
CDN_IMAGEBED_UNICOM_PROTOCOL=https

# 移动用户CDN
CDN_IMAGEBED_MOBILE_DOMAIN=img.yourdomain.com
CDN_IMAGEBED_MOBILE_PROTOCOL=https

# 电信用户CDN
CDN_IMAGEBED_TELECOM_DOMAIN=img.yourdomain.com
CDN_IMAGEBED_TELECOM_PROTOCOL=https

# 海外用户CDN
CDN_IMAGEBED_OVERSEAS_DOMAIN=img.yourdomain.com
CDN_IMAGEBED_OVERSEAS_PROTOCOL=https

# 默认CDN（无法识别地区时使用）
CDN_IMAGEBED_DEFAULT_DOMAIN=img.yourdomain.com
CDN_IMAGEBED_DEFAULT_PROTOCOL=https

# ==== 文件服务器CDN配置 ====
CDN_FILE_UNICOM_DOMAIN=img.yourdomain.com
CDN_FILE_UNICOM_PROTOCOL=https
CDN_FILE_MOBILE_DOMAIN=img.yourdomain.com
CDN_FILE_MOBILE_PROTOCOL=https
CDN_FILE_TELECOM_DOMAIN=img.yourdomain.com
CDN_FILE_TELECOM_PROTOCOL=https
CDN_FILE_OVERSEAS_DOMAIN=img.yourdomain.com
CDN_FILE_OVERSEAS_PROTOCOL=https
CDN_FILE_DEFAULT_DOMAIN=img.yourdomain.com
CDN_FILE_DEFAULT_PROTOCOL=https

# ==== 视频服务器CDN配置 ====
CDN_VIDEO_UNICOM_DOMAIN=img.yourdomain.com
CDN_VIDEO_UNICOM_PROTOCOL=https
CDN_VIDEO_MOBILE_DOMAIN=img.yourdomain.com
CDN_VIDEO_MOBILE_PROTOCOL=https
CDN_VIDEO_TELECOM_DOMAIN=img.yourdomain.com
CDN_VIDEO_TELECOM_PROTOCOL=https
CDN_VIDEO_OVERSEAS_DOMAIN=img.yourdomain.com
CDN_VIDEO_OVERSEAS_PROTOCOL=https
CDN_VIDEO_DEFAULT_DOMAIN=img.yourdomain.com
CDN_VIDEO_DEFAULT_PROTOCOL=https

# CDN 路由模式
# direct: 直接访问主服务器
# auto: 根据地理位置自动路由
# manual: 手动配置路由规则
CDN_ROUTING_MODE=direct

# 私网 CDN 配置（内网用户访问，可选）
CDN_PRIVATE_DOMAIN=
CDN_PRIVATE_PROTOCOL=http
CDN_PRIVATE_PORT=

# 公网 CDN 配置（外网用户访问，可选）
CDN_PUBLIC_DOMAIN=
CDN_PUBLIC_PROTOCOL=https
CDN_PUBLIC_PORT=

# 降级服务器配置（主服务器故障时使用）
CDN_FALLBACK_DOMAIN=img.yourdomain.com
CDN_FALLBACK_PROTOCOL=https

# ==================== 性能和安全配置 ====================
# 本地缓存过期时间（秒）- L1 缓存
CACHE_LOCAL_TTL=300

# Redis 缓存过期时间（秒）- L2 缓存
CACHE_TTL=3600

# 限流配置
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=60

# ==================== 日志配置 ====================
# 日志级别: debug, info, warn, error
LOG_LEVEL=info

# ==================== API 密钥配置 ====================
# Dashboard API 密钥（用于图床服务认证）
# ⚠️ 必须与图床后端的 SHORT_LINK_API_KEY 完全一致！
# 建议使用至少60个字符的随机字符串
DASHBOARD_API_KEY=your_api_key_here_minimum_60_characters

# 外部 API 密钥（可选，用于其他服务调用）
API_KEY=your_api_key_here_minimum_60_characters

# 是否启用API密钥认证
API_KEY_ENABLED=true

# ==================== 管理功能配置 ====================
# 启用管理员认证
ADMIN_AUTH_ENABLED=true
# 管理员用户名
ADMIN_USERNAME=admin
# 管理员密码
ADMIN_PASSWORD=your_secure_admin_password

# ==================== 监控配置 ====================
# 启用 Prometheus 监控
ENABLE_METRICS=true
# 监控端口
METRICS_PORT=9145

# ==================== GeoIP 配置 ====================
# 启用地理位置路由
ENABLE_GEOIP=true
# GeoIP 数据库路径（容器内路径）
GEOIP_CITY_DB=/usr/local/openresty/nginx/geoip/GeoLite2-City.mmdb
GEOIP_ASN_DB=/usr/local/openresty/nginx/geoip/GeoLite2-ASN.mmdb

# ==========================================
# 生产环境部署说明:
# 1. 复制此文件为 .env
# 2. 修改所有包含 'your_' 'yourdomain' 的配置项
# 3. DASHBOARD_API_KEY 必须与图床服务的 SHORT_LINK_API_KEY 一致
# 4. REDIS_DB 必须设置为 1（与图床服务统一）
# 5. 确保所有密码使用强随机字符串
# ==========================================

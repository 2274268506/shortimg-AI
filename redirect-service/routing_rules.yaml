# ========================================
# ğŸ¯ çŸ­é“¾æœåŠ¡åˆ†æµé…ç½®
# ========================================
#
# ğŸ“‹ é…ç½®è¯´æ˜:
#   1. CDNèŠ‚ç‚¹å®šä¹‰ - é…ç½®æ‰€æœ‰å¯ç”¨çš„CDNèŠ‚ç‚¹
#   2. åˆ†æµè§„åˆ™ - å®šä¹‰æµé‡åˆ†é…è§„åˆ™ï¼ˆæŒ‰ä¼˜å…ˆçº§åŒ¹é…ï¼‰
#   3. é»˜è®¤è·¯ç”± - æ— è§„åˆ™åŒ¹é…æ—¶çš„é™çº§ç­–ç•¥
#
# âš¡ è§„åˆ™åŒ¹é…é€»è¾‘:
#   - æŒ‰ priority ä»å°åˆ°å¤§ä¾æ¬¡æ£€æŸ¥è§„åˆ™
#   - è§„åˆ™ä¸­çš„æ‰€æœ‰ conditions å¿…é¡»å…¨éƒ¨æ»¡è¶³ï¼ˆANDé€»è¾‘ï¼‰
#   - åŒ¹é…æˆåŠŸåç«‹å³è¿”å›ï¼Œä¸å†æ£€æŸ¥åç»­è§„åˆ™
#   - æ— è§„åˆ™åŒ¹é…æ—¶ä½¿ç”¨ default_routing é…ç½®
#
# ğŸ”„ çƒ­æ›´æ–°:
#   ä¿®æ”¹æ­¤æ–‡ä»¶åï¼Œé…ç½®ä¼šåœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶è‡ªåŠ¨ç”Ÿæ•ˆ
#   æ— éœ€é‡å¯æœåŠ¡ï¼ˆç¼“å­˜é»˜è®¤5åˆ†é’Ÿï¼‰
#
# ğŸ“– è¯¦ç»†æ–‡æ¡£:
#   - å¿«é€Ÿå…¥é—¨: ROUTING_QUICK_START.md
#   - å®Œæ•´æŒ‡å—: ROUTING_CONFIG_GUIDE.md
#   - é…ç½®éªŒè¯: lua scripts/validate_routing.lua
# ========================================

# ========================================
# ğŸ“¡ ç¬¬ä¸€éƒ¨åˆ†: CDNèŠ‚ç‚¹å®šä¹‰
# ========================================
# è¯´æ˜:
#   - id: èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†ï¼ˆåœ¨è§„åˆ™ä¸­å¼•ç”¨ï¼‰
#   - name: èŠ‚ç‚¹æ˜¾ç¤ºåç§°ï¼ˆç”¨äºæ—¥å¿—ï¼‰
#   - domain_env/protocol_env/port_env: ä» .env è¯»å–çš„ç¯å¢ƒå˜é‡å
#   - default_*: ç¯å¢ƒå˜é‡æœªè®¾ç½®æ—¶çš„é»˜è®¤å€¼
#
# ç¯å¢ƒå˜é‡é…ç½®ä½ç½®: .env æ–‡ä»¶

cdn_nodes:
  # ========================================
  # ç§æœ‰ç½‘ç»œèŠ‚ç‚¹
  # ========================================
  - id: private
    name: ç§æœ‰ç½‘ç»œCDN
    domain_env: CDN_PRIVATE_DOMAIN
    protocol_env: CDN_PRIVATE_PROTOCOL
    port_env: CDN_PRIVATE_PORT
    default_domain: localhost
    default_protocol: http
    default_port: 8080

  # ========================================
  # å›¾åºŠæœåŠ¡å™¨ç¾¤ç»„ï¼ˆè”é€š/ç§»åŠ¨/ç”µä¿¡ï¼‰
  # ========================================
  - id: imagebed_unicom
    name: å›¾åºŠè”é€šCDN
    domain_env: CDN_IMAGEBED_UNICOM_DOMAIN
    protocol_env: CDN_IMAGEBED_UNICOM_PROTOCOL
    port_env: CDN_IMAGEBED_UNICOM_PORT
    default_domain: img-unicom.example.com
    default_protocol: https

  - id: imagebed_mobile
    name: å›¾åºŠç§»åŠ¨CDN
    domain_env: CDN_IMAGEBED_MOBILE_DOMAIN
    protocol_env: CDN_IMAGEBED_MOBILE_PROTOCOL
    port_env: CDN_IMAGEBED_MOBILE_PORT
    default_domain: img-mobile.example.com
    default_protocol: https

  - id: imagebed_telecom
    name: å›¾åºŠç”µä¿¡CDN
    domain_env: CDN_IMAGEBED_TELECOM_DOMAIN
    protocol_env: CDN_IMAGEBED_TELECOM_PROTOCOL
    port_env: CDN_IMAGEBED_TELECOM_PORT
    default_domain: img-telecom.example.com
    default_protocol: https

  - id: imagebed_overseas
    name: å›¾åºŠæµ·å¤–CDN
    domain_env: CDN_IMAGEBED_OVERSEAS_DOMAIN
    protocol_env: CDN_IMAGEBED_OVERSEAS_PROTOCOL
    port_env: CDN_IMAGEBED_OVERSEAS_PORT
    default_domain: img-overseas.example.com
    default_protocol: https

  - id: imagebed_default
    name: å›¾åºŠé»˜è®¤CDN
    domain_env: CDN_IMAGEBED_DEFAULT_DOMAIN
    protocol_env: CDN_IMAGEBED_DEFAULT_PROTOCOL
    port_env: CDN_IMAGEBED_DEFAULT_PORT
    default_domain: img-cdn.example.com
    default_protocol: https

  # ========================================
  # æ–‡ä»¶æœåŠ¡å™¨ç¾¤ç»„ï¼ˆè”é€š/ç§»åŠ¨/ç”µä¿¡ï¼‰
  # ========================================
  - id: file_unicom
    name: æ–‡ä»¶è”é€šCDN
    domain_env: CDN_FILE_UNICOM_DOMAIN
    protocol_env: CDN_FILE_UNICOM_PROTOCOL
    port_env: CDN_FILE_UNICOM_PORT
    default_domain: file-unicom.example.com
    default_protocol: https

  - id: file_mobile
    name: æ–‡ä»¶ç§»åŠ¨CDN
    domain_env: CDN_FILE_MOBILE_DOMAIN
    protocol_env: CDN_FILE_MOBILE_PROTOCOL
    port_env: CDN_FILE_MOBILE_PORT
    default_domain: file-mobile.example.com
    default_protocol: https

  - id: file_telecom
    name: æ–‡ä»¶ç”µä¿¡CDN
    domain_env: CDN_FILE_TELECOM_DOMAIN
    protocol_env: CDN_FILE_TELECOM_PROTOCOL
    port_env: CDN_FILE_TELECOM_PORT
    default_domain: file-telecom.example.com
    default_protocol: https

  - id: file_overseas
    name: æ–‡ä»¶æµ·å¤–CDN
    domain_env: CDN_FILE_OVERSEAS_DOMAIN
    protocol_env: CDN_FILE_OVERSEAS_PROTOCOL
    port_env: CDN_FILE_OVERSEAS_PORT
    default_domain: file-overseas.example.com
    default_protocol: https

  - id: file_default
    name: æ–‡ä»¶é»˜è®¤CDN
    domain_env: CDN_FILE_DEFAULT_DOMAIN
    protocol_env: CDN_FILE_DEFAULT_PROTOCOL
    port_env: CDN_FILE_DEFAULT_PORT
    default_domain: file-cdn.example.com
    default_protocol: https

  # ========================================
  # è§†é¢‘æœåŠ¡å™¨ç¾¤ç»„ï¼ˆè”é€š/ç§»åŠ¨/ç”µä¿¡ï¼‰
  # ========================================
  - id: video_unicom
    name: è§†é¢‘è”é€šCDN
    domain_env: CDN_VIDEO_UNICOM_DOMAIN
    protocol_env: CDN_VIDEO_UNICOM_PROTOCOL
    port_env: CDN_VIDEO_UNICOM_PORT
    default_domain: video-unicom.example.com
    default_protocol: https

  - id: video_mobile
    name: è§†é¢‘ç§»åŠ¨CDN
    domain_env: CDN_VIDEO_MOBILE_DOMAIN
    protocol_env: CDN_VIDEO_MOBILE_PROTOCOL
    port_env: CDN_VIDEO_MOBILE_PORT
    default_domain: video-mobile.example.com
    default_protocol: https

  - id: video_telecom
    name: è§†é¢‘ç”µä¿¡CDN
    domain_env: CDN_VIDEO_TELECOM_DOMAIN
    protocol_env: CDN_VIDEO_TELECOM_PROTOCOL
    port_env: CDN_VIDEO_TELECOM_PORT
    default_domain: video-telecom.example.com
    default_protocol: https

  - id: video_overseas
    name: è§†é¢‘æµ·å¤–CDN
    domain_env: CDN_VIDEO_OVERSEAS_DOMAIN
    protocol_env: CDN_VIDEO_OVERSEAS_PROTOCOL
    port_env: CDN_VIDEO_OVERSEAS_PORT
    default_domain: video-overseas.example.com
    default_protocol: https

  - id: video_default
    name: è§†é¢‘é»˜è®¤CDN
    domain_env: CDN_VIDEO_DEFAULT_DOMAIN
    protocol_env: CDN_VIDEO_DEFAULT_PROTOCOL
    port_env: CDN_VIDEO_DEFAULT_PORT
    default_domain: video-cdn.example.com
    default_protocol: https

  # ========================================
  # é€šç”¨æœåŠ¡å™¨èŠ‚ç‚¹
  # ========================================
  - id: general_unicom
    name: é€šç”¨è”é€šCDN
    domain_env: CDN_GENERAL_UNICOM_DOMAIN
    protocol_env: CDN_GENERAL_UNICOM_PROTOCOL
    port_env: CDN_GENERAL_UNICOM_PORT
    default_domain: cdn-unicom.example.com
    default_protocol: https

  - id: general_mobile
    name: é€šç”¨ç§»åŠ¨CDN
    domain_env: CDN_GENERAL_MOBILE_DOMAIN
    protocol_env: CDN_GENERAL_MOBILE_PROTOCOL
    port_env: CDN_GENERAL_MOBILE_PORT
    default_domain: cdn-mobile.example.com
    default_protocol: https

  - id: general_telecom
    name: é€šç”¨ç”µä¿¡CDN
    domain_env: CDN_GENERAL_TELECOM_DOMAIN
    protocol_env: CDN_GENERAL_TELECOM_PROTOCOL
    port_env: CDN_GENERAL_TELECOM_PORT
    default_domain: cdn-telecom.example.com
    default_protocol: https

  - id: general_overseas
    name: é€šç”¨æµ·å¤–CDN
    domain_env: CDN_GENERAL_OVERSEAS_DOMAIN
    protocol_env: CDN_GENERAL_OVERSEAS_PROTOCOL
    port_env: CDN_GENERAL_OVERSEAS_PORT
    default_domain: cdn-overseas.example.com
    default_protocol: https

  - id: general_default
    name: é€šç”¨é»˜è®¤CDN
    domain_env: CDN_GENERAL_DEFAULT_DOMAIN
    protocol_env: CDN_GENERAL_DEFAULT_PROTOCOL
    port_env: CDN_GENERAL_DEFAULT_PORT
    default_domain: cdn.example.com
    default_protocol: https

  # ========================================
  # å¤‡ç”¨èŠ‚ç‚¹
  # ========================================
  - id: backup
    name: å¤‡ç”¨CDN
    domain_env: CDN_BACKUP_DOMAIN
    protocol_env: CDN_BACKUP_PROTOCOL
    port_env: CDN_BACKUP_PORT
    default_domain: cdn-backup.example.com
    default_protocol: https

# ========================================
# ğŸ“‹ ç¬¬äºŒéƒ¨åˆ†: åˆ†æµè§„åˆ™é…ç½®
# ========================================
# è¯´æ˜:
#   - name: è§„åˆ™åç§°ï¼ˆä¾¿äºè¯†åˆ«ï¼Œå»ºè®®å‘½åæ¸…æ™°ï¼‰
#   - priority: ä¼˜å…ˆçº§ï¼ˆ1-999ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰
#   - enabled: æ˜¯å¦å¯ç”¨ï¼ˆtrue/falseï¼Œå¯å¿«é€Ÿå¯ç”¨/ç¦ç”¨è§„åˆ™ï¼‰
#   - conditions: åŒ¹é…æ¡ä»¶åˆ—è¡¨ï¼ˆæ‰€æœ‰æ¡ä»¶å¿…é¡»åŒæ—¶æ»¡è¶³ï¼‰
#   - target: ç›®æ ‡CDNèŠ‚ç‚¹IDï¼ˆå¿…é¡»åœ¨ cdn_nodes ä¸­å®šä¹‰ï¼‰
#
# ğŸ’¡ ä¼˜å…ˆçº§å»ºè®®:
#   1-10:   å…³é”®ä¸šåŠ¡è§„åˆ™ï¼ˆVIPç”¨æˆ·ã€æµ‹è¯•æµé‡ï¼‰
#   11-50:  åœ°ç†ä½ç½®è§„åˆ™ï¼ˆåœ°åŸŸã€è¿è¥å•†ï¼‰
#   51-100: åŠŸèƒ½æ€§è§„åˆ™ï¼ˆè·¯å¾„ã€æ—¶é—´æ®µï¼‰
#   101+:   å®éªŒæ€§è§„åˆ™ï¼ˆA/Bæµ‹è¯•ã€ç°åº¦ï¼‰
#
# ğŸ“ æ¡ä»¶ç±»å‹æ”¯æŒ:
#   ip_range     - IPåœ°å€æ®µï¼ˆCIDRæ ¼å¼ï¼Œå¦‚ 192.168.0.0/16ï¼‰
#   province     - çœä»½åç§°åˆ—è¡¨
#   isp          - è¿è¥å•†åç§°åˆ—è¡¨
#   country      - å›½å®¶ä»£ç ï¼ˆå¦‚ CNï¼‰
#   asn          - è‡ªæ²»ç³»ç»Ÿå·åˆ—è¡¨
#   path_prefix  - URLè·¯å¾„å‰ç¼€åˆ—è¡¨
#   time_range   - æ—¶é—´èŒƒå›´ï¼ˆstart_hour, end_hourï¼‰
#   percentage   - ç™¾åˆ†æ¯”ï¼ˆ0-100ï¼‰
#   header       - HTTPè¯·æ±‚å¤´ï¼ˆname, valueï¼‰
#   query_param  - URLå‚æ•°ï¼ˆname, valueï¼‰

routing_rules:
  # ========================================
  # è§„åˆ™1: å†…ç½‘IPä½¿ç”¨ç§æœ‰CDNï¼ˆæ‰€æœ‰ç±»å‹ï¼‰
  # ä¼˜å…ˆçº§: 10ï¼ˆæœ€é«˜ï¼‰
  # ========================================
  - name: å†…ç½‘IPè·¯ç”±
    priority: 10
    enabled: true
    conditions:
      - type: ip_range
        ranges:
          - 10.0.0.0/8
          - 172.16.0.0/12
          - 192.168.0.0/16
          - 127.0.0.0/8
    target: private

  # ========================================
  # å›¾åºŠçŸ­é“¾è·¯ç”±è§„åˆ™ï¼ˆpriority 20-29ï¼‰
  # ========================================
  # è§„åˆ™2: å›¾åºŠ + ç”µä¿¡ç”¨æˆ·
  - name: å›¾åºŠ_ç”µä¿¡
    priority: 20
    enabled: true
    conditions:
      - type: service_type
        value: imagebed
      - type: isp
        values:
          - China Telecom
          - ChinaNet
          - ç”µä¿¡
    target: imagebed_telecom

  # è§„åˆ™3: å›¾åºŠ + è”é€šç”¨æˆ·
  - name: å›¾åºŠ_è”é€š
    priority: 21
    enabled: true
    conditions:
      - type: service_type
        value: imagebed
      - type: isp
        values:
          - China Unicom
          - è”é€š
    target: imagebed_unicom

  # è§„åˆ™4: å›¾åºŠ + ç§»åŠ¨ç”¨æˆ·
  - name: å›¾åºŠ_ç§»åŠ¨
    priority: 22
    enabled: true
    conditions:
      - type: service_type
        value: imagebed
      - type: isp
        values:
          - China Mobile
          - ç§»åŠ¨
    target: imagebed_mobile

  # è§„åˆ™5: å›¾åºŠ + æµ·å¤–ç”¨æˆ·
  - name: å›¾åºŠ_æµ·å¤–
    priority: 23
    enabled: true
    conditions:
      - type: service_type
        value: imagebed
      - type: country
        operator: not_equals
        value: CN
    target: imagebed_overseas

  # è§„åˆ™6: å›¾åºŠ + å›½å†…å…¶ä»–ç”¨æˆ·
  - name: å›¾åºŠ_å›½å†…é»˜è®¤
    priority: 24
    enabled: true
    conditions:
      - type: service_type
        value: imagebed
    target: imagebed_default

  # ========================================
  # æ–‡ä»¶çŸ­é“¾è·¯ç”±è§„åˆ™ï¼ˆpriority 30-39ï¼‰
  # ========================================
  # è§„åˆ™7: æ–‡ä»¶ + ç”µä¿¡ç”¨æˆ·
  - name: æ–‡ä»¶_ç”µä¿¡
    priority: 30
    enabled: true
    conditions:
      - type: service_type
        value: file
      - type: isp
        values:
          - China Telecom
          - ChinaNet
          - ç”µä¿¡
    target: file_telecom

  # è§„åˆ™8: æ–‡ä»¶ + è”é€šç”¨æˆ·
  - name: æ–‡ä»¶_è”é€š
    priority: 31
    enabled: true
    conditions:
      - type: service_type
        value: file
      - type: isp
        values:
          - China Unicom
          - è”é€š
    target: file_unicom

  # è§„åˆ™9: æ–‡ä»¶ + ç§»åŠ¨ç”¨æˆ·
  - name: æ–‡ä»¶_ç§»åŠ¨
    priority: 32
    enabled: true
    conditions:
      - type: service_type
        value: file
      - type: isp
        values:
          - China Mobile
          - ç§»åŠ¨
    target: file_mobile

  # è§„åˆ™10: æ–‡ä»¶ + æµ·å¤–ç”¨æˆ·
  - name: æ–‡ä»¶_æµ·å¤–
    priority: 33
    enabled: true
    conditions:
      - type: service_type
        value: file
      - type: country
        operator: not_equals
        value: CN
    target: file_overseas

  # è§„åˆ™11: æ–‡ä»¶ + å›½å†…å…¶ä»–ç”¨æˆ·
  - name: æ–‡ä»¶_å›½å†…é»˜è®¤
    priority: 34
    enabled: true
    conditions:
      - type: service_type
        value: file
    target: file_default

  # ========================================
  # è§†é¢‘çŸ­é“¾è·¯ç”±è§„åˆ™ï¼ˆpriority 40-49ï¼‰
  # ========================================
  # è§„åˆ™12: è§†é¢‘ + ç”µä¿¡ç”¨æˆ·
  - name: è§†é¢‘_ç”µä¿¡
    priority: 40
    enabled: true
    conditions:
      - type: service_type
        value: video
      - type: isp
        values:
          - China Telecom
          - ChinaNet
          - ç”µä¿¡
    target: video_telecom

  # è§„åˆ™13: è§†é¢‘ + è”é€šç”¨æˆ·
  - name: è§†é¢‘_è”é€š
    priority: 41
    enabled: true
    conditions:
      - type: service_type
        value: video
      - type: isp
        values:
          - China Unicom
          - è”é€š
    target: video_unicom

  # è§„åˆ™14: è§†é¢‘ + ç§»åŠ¨ç”¨æˆ·
  - name: è§†é¢‘_ç§»åŠ¨
    priority: 42
    enabled: true
    conditions:
      - type: service_type
        value: video
      - type: isp
        values:
          - China Mobile
          - ç§»åŠ¨
    target: video_mobile

  # è§„åˆ™15: è§†é¢‘ + æµ·å¤–ç”¨æˆ·
  - name: è§†é¢‘_æµ·å¤–
    priority: 43
    enabled: true
    conditions:
      - type: service_type
        value: video
      - type: country
        operator: not_equals
        value: CN
    target: video_overseas

  # è§„åˆ™16: è§†é¢‘ + å›½å†…å…¶ä»–ç”¨æˆ·
  - name: è§†é¢‘_å›½å†…é»˜è®¤
    priority: 44
    enabled: true
    conditions:
      - type: service_type
        value: video
    target: video_default

  # ========================================
  # é€šç”¨çŸ­é“¾è·¯ç”±è§„åˆ™ï¼ˆpriority 50-59ï¼‰
  # ========================================
  # è§„åˆ™17: é€šç”¨ + ç”µä¿¡ç”¨æˆ·
  - name: é€šç”¨_ç”µä¿¡
    priority: 50
    enabled: true
    conditions:
      - type: service_type
        value: general
      - type: isp
        values:
          - China Telecom
          - ChinaNet
          - ç”µä¿¡
    target: general_telecom

  # è§„åˆ™18: é€šç”¨ + è”é€šç”¨æˆ·
  - name: é€šç”¨_è”é€š
    priority: 51
    enabled: true
    conditions:
      - type: service_type
        value: general
      - type: isp
        values:
          - China Unicom
          - è”é€š
    target: general_unicom

  # è§„åˆ™19: é€šç”¨ + ç§»åŠ¨ç”¨æˆ·
  - name: é€šç”¨_ç§»åŠ¨
    priority: 52
    enabled: true
    conditions:
      - type: service_type
        value: general
      - type: isp
        values:
          - China Mobile
          - ç§»åŠ¨
    target: general_mobile

  # è§„åˆ™20: é€šç”¨ + æµ·å¤–ç”¨æˆ·
  - name: é€šç”¨_æµ·å¤–
    priority: 53
    enabled: true
    conditions:
      - type: service_type
        value: general
      - type: country
        operator: not_equals
        value: CN
    target: general_overseas

  # è§„åˆ™21: é€šç”¨ + å›½å†…å…¶ä»–ç”¨æˆ·
  - name: é€šç”¨_å›½å†…é»˜è®¤
    priority: 54
    enabled: true
    conditions:
      - type: service_type
        value: general
    target: general_default
  # ========================================
  # é«˜çº§è§„åˆ™ç¤ºä¾‹ï¼ˆé»˜è®¤ç¦ç”¨ï¼ŒæŒ‰éœ€å¯ç”¨ï¼‰
  # ========================================

  # è§„åˆ™: å¤œé—´ç»´æŠ¤çª—å£ä½¿ç”¨å¤‡ä»½CDN
  # ä¼˜å…ˆçº§: 70
  # åœºæ™¯: ä¸»CDNå¤œé—´ç»´æŠ¤æ—¶çš„æµé‡åˆ‡æ¢
  - name: å¤œé—´å¤‡ä»½è·¯ç”±
    priority: 70
    enabled: false  # éœ€è¦æ—¶å¯ç”¨
    conditions:
      - type: time_range
        start_hour: 2    # å‡Œæ™¨2ç‚¹
        end_hour: 6      # æ—©ä¸Š6ç‚¹
    target: backup

  # è§„åˆ™: A/Bæµ‹è¯•åˆ†æµ
  # ä¼˜å…ˆçº§: 80
  # åœºæ™¯: æ–°CDNç°åº¦å‘å¸ƒã€æ€§èƒ½å¯¹æ¯”æµ‹è¯•
  - name: ABæµ‹è¯•åˆ†æµ
    priority: 80
    enabled: false  # éœ€è¦æ—¶å¯ç”¨
    conditions:
      - type: percentage
        value: 20  # 20%çš„æµé‡åˆ°æ–°CDN
    target: backup

  # è§„åˆ™: å®¢æˆ·ç«¯æŒ‡å®šCDN
  # ä¼˜å…ˆçº§: 90
  # åœºæ™¯: å…è®¸å®¢æˆ·ç«¯é€šè¿‡HeaderæŒ‡å®šCDN
  - name: è‡ªå®šä¹‰Headerè·¯ç”±
    priority: 90
    enabled: false  # éœ€è¦æ—¶å¯ç”¨
    conditions:
      - type: header
        name: X-CDN-Prefer
        value: backup
    target: backup

  # è§„åˆ™: URLå‚æ•°åŠ¨æ€è·¯ç”±
  # ä¼˜å…ˆçº§: 100
  # åœºæ™¯: è°ƒè¯•ã€æµ‹è¯•ç‰¹å®šCDN
  # ä½¿ç”¨: http://short.domain.com/abc?cdn=overseas
  - name: URLå‚æ•°è·¯ç”±
    priority: 100
    enabled: false  # éœ€è¦æ—¶å¯ç”¨
    conditions:
      - type: query_param
        name: cdn
        value: overseas
    target: overseas

# ========================================
# ğŸ”„ ç¬¬ä¸‰éƒ¨åˆ†: é»˜è®¤è·¯ç”±å’Œé™çº§ç­–ç•¥
# ========================================
# è¯´æ˜:
#   - target: æ— è§„åˆ™åŒ¹é…æ—¶ä½¿ç”¨çš„é»˜è®¤CDN
#   - fallback_chain: CDNæ•…éšœæ—¶çš„é™çº§é¡ºåº
#
# é™çº§é€»è¾‘:
#   1. å°è¯•ä½¿ç”¨è§„åˆ™åŒ¹é…çš„ç›®æ ‡CDN
#   2. å¦‚æœç›®æ ‡CDNä¸å¯ç”¨ï¼ŒæŒ‰é™çº§é“¾é¡ºåºå°è¯•
#   3. æ‰€æœ‰CDNéƒ½ä¸å¯ç”¨æ—¶è¿”å›é”™è¯¯

default_routing:
  # é»˜è®¤ç›®æ ‡CDNï¼ˆé€šç”¨é»˜è®¤èŠ‚ç‚¹ï¼‰
  target: general_default

  # é™çº§é“¾ï¼ˆæŒ‰æœåŠ¡ç±»å‹åˆ†åˆ«é™çº§ï¼‰
  # å›¾åºŠç±»å‹é™çº§é¡ºåº
  imagebed_fallback:
    - imagebed_default
    - general_default
    - backup

  # æ–‡ä»¶ç±»å‹é™çº§é¡ºåº
  file_fallback:
    - file_default
    - general_default
    - backup

  # è§†é¢‘ç±»å‹é™çº§é¡ºåº
  video_fallback:
    - video_default
    - general_default
    - backup

  # é€šç”¨ç±»å‹é™çº§é¡ºåº
  general_fallback:
    - general_default
    - backup

# ========================================
# âš™ï¸ ç¬¬å››éƒ¨åˆ†: é«˜çº§é…ç½®
# ========================================
# è¯´æ˜:
#   æ€§èƒ½ä¼˜åŒ–ã€æ—¥å¿—æ§åˆ¶ã€å¥åº·æ£€æŸ¥ç­‰é«˜çº§é€‰é¡¹

advanced:
  # è§„åˆ™ç¼“å­˜ï¼ˆæé«˜æ€§èƒ½ï¼‰
  enable_rule_cache: true
  cache_ttl: 300  # ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé»˜è®¤5åˆ†é’Ÿ

  # è·¯ç”±æ—¥å¿—ï¼ˆè°ƒè¯•ç”¨ï¼‰
  # ç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­ä»¥æå‡æ€§èƒ½
  enable_routing_log: false

  # å¥åº·æ£€æŸ¥
  enable_health_check: true
  health_check_interval: 30  # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰

  # å¤±è´¥é‡è¯•
  max_retries: 3      # æœ€å¤§é‡è¯•æ¬¡æ•°
  retry_delay: 1      # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰

# ========================================
# ğŸ“ é…ç½®ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
# ========================================
#
# ç¤ºä¾‹1: ç®€å•å†…å¤–ç½‘åˆ†æµ
# ----------------------------
# routing_rules:
#   - name: å†…ç½‘ç”¨æˆ·
#     priority: 10
#     enabled: true
#     conditions:
#       - type: ip_range
#         ranges: [192.168.0.0/16]
#     target: private
#
#   - name: å¤–ç½‘ç”¨æˆ·ï¼ˆé»˜è®¤ï¼‰
#     priority: 100
#     enabled: true
#     conditions: []
#     target: public
#
# ç¤ºä¾‹2: ç”µä¿¡è”é€šåˆ†æµ
# ----------------------------
# routing_rules:
#   - name: ç”µä¿¡ç”¨æˆ·
#     priority: 20
#     enabled: true
#     conditions:
#       - type: isp
#         values: [China Telecom]
#     target: telecom_cdn
#
#   - name: è”é€šç”¨æˆ·
#     priority: 30
#     enabled: true
#     conditions:
#       - type: isp
#         values: [China Unicom]
#     target: unicom_cdn
#
# ç¤ºä¾‹3: å¤æ‚ç»„åˆæ¡ä»¶
# ----------------------------
# routing_rules:
#   - name: åŒ—äº¬ç”µä¿¡VIPç”¨æˆ·
#     priority: 5
#     enabled: true
#     conditions:
#       - type: province
#         values: [åŒ—äº¬]
#       - type: isp
#         values: [China Telecom]
#       - type: header
#         name: X-User-Level
#         value: VIP
#     target: vip_cdn
#
# ğŸ’¡ æœ€ä½³å®è·µ:
#   1. ä¼˜å…ˆçº§è®¾ç½®: å…³é”®è§„åˆ™1-10ï¼Œåœ°åŸŸè§„åˆ™11-50ï¼ŒåŠŸèƒ½è§„åˆ™51-100
#   2. è§„åˆ™å‘½å: ä½¿ç”¨æ¸…æ™°æè¿°æ€§çš„åç§°ï¼Œä¾¿äºç»´æŠ¤
#   3. æ¡ä»¶ç»„åˆ: å¤šä¸ªæ¡ä»¶æ˜¯ANDå…³ç³»ï¼Œéƒ½è¦æ»¡è¶³æ‰åŒ¹é…
#   4. æµ‹è¯•è§„åˆ™: ä½¿ç”¨ enabled:false æš‚æ—¶ç¦ç”¨ï¼Œè€Œä¸æ˜¯åˆ é™¤
#   5. é™çº§ç­–ç•¥: é…ç½®å¤šä¸ªå¤‡é€‰CDNï¼Œç¡®ä¿é«˜å¯ç”¨
#   6. æ€§èƒ½ä¼˜åŒ–: ç”Ÿäº§ç¯å¢ƒå…³é—­è·¯ç”±æ—¥å¿—ï¼Œå¯ç”¨ç¼“å­˜
#   7. ç°åº¦å‘å¸ƒ: ä½¿ç”¨ percentage æ¡ä»¶é€æ­¥åˆ‡æ¢CDN
#
# ========================================
